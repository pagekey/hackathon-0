var Gmail=function(e){var _;if(void 0!==e)_=e;else if("undefined"!=typeof jQuery)_=jQuery;else try{_=require("jquery")}catch(e){}var t="undefined"!=typeof window?window.opener:null;if(t)try{t.document.domain!==window.document.domain&&(console.warn("GmailJS: window.opener domain differs from window domain."),t=null)}catch(e){console.warn("GmailJS: Unable to access window.opener!",e),t=null}var y={get:{},observe:{},check:{data:{}},tools:{},tracker:{},dom:{},chat:{},compose:{},helper:{get:{}}};function r(e="Migrate to new API compatible with new Gmail to silence this warning!"){y.DISABLE_OLD_GMAIL_API_DEPRECATION_WARNINGS||console.warn("GmailJS: using deprecated API for old Gmail.",e)}y.DISABLE_OLD_GMAIL_API_DEPRECATION_WARNINGS=!1,y.version="0.8.0",y.tracker.globals="undefined"!=typeof GLOBALS?GLOBALS:t&&t.GLOBALS||[],y.tracker.view_data="undefined"!=typeof VIEW_DATA?VIEW_DATA:t&&t.VIEW_DATA||[],y.tracker.ik=y.tracker.globals[9]||"",y.tracker.mla=void 0,y.tracker.hangouts=void 0,y.cache={},y.cache.debug_xhr_fetch=!1,y.cache.emailIdCache={},y.cache.emailLegacyIdCache={},y.cache.threadCache={},y.get.last_active=function(){var e=y.tracker.globals[17][15];return{time:e[1],ip:e[3],mac_address:e[9],time_relative:e[10]}},y.get.loggedin_accounts=function(){const e=y.tracker.mla;return Array.isArray(e)?e[1].map(e=>({name:e[4],email:e[0],index:e[3]})):[]},y.get.user_email=function(){return y.tracker.globals[10]},y.get.manager_email=function(){return y.helper.get.is_delegated_inbox()?y.get.delegated_to_email():y.get.user_email()},y.get.delegated_to_email=function(){if(!y.helper.get.is_delegated_inbox())return null;const e=window.location.pathname,t=parseInt(e.substring(e.indexOf("/u/")+"/u/".length),10),r=y.get.loggedin_accounts();var a=r.find(e=>e.index===t);return a?a.email:null},y.helper.get.is_locale=function(e){if(!e||"string"!=typeof e||e.length<2)return!1;if(e.match(/[0-9]/))return!1;e=e.slice(0,2);return e.toLowerCase()===e||e.toUpperCase()===e},y.helper.filter_locale=function(e){return y.helper.get.is_locale(e)?e.substring(0,2).toLowerCase():null},y.helper.array_starts_with=function(e,t){return!!(e&&0<e.length&&e[0]===t)},y.helper.get.array_sublist=function(e,t){if(e)for(var r=0;r<e.length;r++){var a=e[r];if(y.helper.array_starts_with(a,t))return a}return null},y.helper.get.locale_from_url_params=function(e){if(e&&e.indexOf&&(0===e.indexOf("https://")||0===e.indexOf("http://"))){e=e.split("?");if(1<e.length)for(var t=e[1].split("&"),r=0;r<t.length;r++){var a=t[r].split("=");if(2===a.length&&"hl"===a[0])return a[1]}}return null},y.helper.get.locale_from_globals_item=function(e){if(!e)return null;for(var t=0;t<e.length;t++){var r=e[t],r=y.helper.get.locale_from_url_params(r);if(r)return r}return e[8]},y.get.localization=function(){var e=y.tracker.globals,t=y.helper.get.array_sublist(e[17],"ui");if(null!==t&&8<t.length){t=y.helper.get.locale_from_globals_item(t);if(t=y.helper.filter_locale(t))return t}if(null!==e[12]){t=y.helper.get.locale_from_url_params(e[12]);if(t=y.helper.filter_locale(t))return t}if(e[4]){t=e[4].split(".")[1];if(t=y.helper.filter_locale(t))return t}return null},y.check.is_new_data_layer=function(){return"true"===window.GM_SPT_ENABLED},y.check.is_new_gui=function(){return"true"===window.GM_RFT_ENABLED},y.check.is_thread=function(){var e=_(".nH .if,.iY").children(":eq(1)").children().children(":eq(1)").children(),t=y.get.email_ids();return 1<e.length||1<t.length},y.check.is_peoplekit_compose=function(e){return 0!==_(e).find("div[name=to] input[peoplekit-id]").length},y.dom.inbox_content=function(){return _("div[role=main]:first")},y.check.is_preview_pane=function(){var e=y.dom.inbox_content().find("[gh=tl]"),t=!1;return e.each(function(){_(this).hasClass("aia")&&(t=!0)}),t},y.check.is_multiple_inbox=function(){return 1<y.dom.inboxes().length},y.check.is_horizontal_split=function(){return 0===y.dom.inbox_content().find("[gh=tl]").find(".nn").length},y.check.is_vertical_split=function(){return!1===y.check.is_horizontal_split()},y.check.is_tabbed_inbox=function(){return 1===_(".aKh").length},y.check.is_right_side_chat=function(){var e=_(".ApVoH");return 0!==e.length&&":wf"===e[0].getAttribute("aria-labelledby")},y.check.should_compose_fullscreen=function(){console.warn("gmail.js: This function is known to be unreliable, and may be deprecated in a future release.");var t=[];try{t=y.tracker.globals[17][4][1][32]}catch(e){t=["bx_scfs","false"]}return"true"===t[1]},y.check.is_google_apps_user=function(){var e=y.get.user_email();return-1===e.indexOf("gmail.com",e.length-"gmail.com".length)},y.get.storage_info=function(){var e=document.querySelector(".md.mj div"),t=e.querySelectorAll("span")[0].textContent.replace(/,/g,"."),e=e.querySelectorAll("span")[1].textContent.replace(/,/g,"."),r=100*parseFloat(t.replace(/[^0-9\.]/g,""))/parseFloat(e.replace(/[^0-9\.]/g,""));return{used:t,total:e,percent:Math.floor(r)}},y.dom.inboxes=function(){return y.dom.inbox_content().find("[gh=tl]")},y.dom.email_subject=function(){for(var e=_(".hP"),t=0;t<e.length;t++)if(_(e[t]).is(":visible"))return _(e[t]);return _()},y.get.email_subject=function(){return y.dom.email_subject().text()},y.dom.email_body=function(){return _(".nH.hx")},y.dom.toolbar=function(){for(var e=_("[gh='mtb']");1===_(e).children().length;)e=_(e).children().first();return e},y.dom.right_toolbar=function(){for(var e=_("[gh='tm'] [gh='s']").parent();1===_(e).children().length;)e=_(e).children().first();return e},y.check.is_inside_email=function(){if("email"!==y.get.current_page()&&!y.check.is_preview_pane())return!1;for(var e=_(".ii.gt .a3s"),t=[],r=0;r<e.length;r++){var a=e[r].getAttribute("class").split(" ")[2];"undefined"!==a&&void 0!==a&&t.push(e[r])}return 0<t.length},y.check.is_plain_text=function(){for(var e=y.tracker.globals[17][4][1],t=0;t<e.length;t++){var r=e[t];if("bx_cm"===r[0])return"0"===r[1]}return!1},y.dom.email_contents=function(){for(var e=_(".ii.gt div.a3s.aXjCH"),t=[],r=0;r<e.length;r++){var a=e[r].getAttribute("class").split(" ")[2],o=e[r].getAttribute("contenteditable");"undefined"!==a&&void 0!==a&&"true"!==o&&t.push(e[r])}return t},y.get.email_ids=function(){var e;return r(),y.check.is_inside_email()?(e=y.get.email_data(),Object.keys(e.threads)):[]},y.get.compose_ids=function(){for(var e=[],t=_(".M9 [name=draft]"),r=0;r<t.length;r++)"undefined"!==t[r].value&&e.push(t[r].value);return e},y.get.thread_id=function(){r();var e=document.querySelector("h2[data-legacy-thread-id]");if(null!==e)return e.dataset.legacyThreadId},y.get.email_id=function(){return r(),y.get.thread_id()},y.check.is_priority_inbox=function(){return 0<_(".qh").length},y.check.is_rapportive_installed=function(){return 1===_("#rapportive-sidebar").length},y.check.is_streak_installed=function(){return 0<_("[id^='bentoBox'],[id*=' bentoBox'],[class*=' bentoBox'],[class*='bentoBox']").length},y.check.is_anydo_installed=function(){return 0<_("[id^='anydo'],[id*=' anydo'],[class*=' anydo'],[class*='anydo']").length},y.check.is_boomerang_installed=function(){return 0<_("[id^='b4g_'],[id*=' b4g_'],[class*=' b4g_'],[class*='b4g_']").length},y.check.is_xobni_installed=function(){return 0<_("#xobni_frame").length},y.check.is_signal_installed=function(){return 0<_("[id^='Signal'],[id*=' Signal'],[class*=' signal'],[class*='signal']").length},y.check.are_shortcuts_enabled=function(){for(var e=void 0,t=!0,r=y.tracker.globals[17][4][1],a=0;a<r.length;a++){var o=r[a];if("bx_hs"===o[0]){e=o[1];break}}return void 0!==e&&(t={0:!0,1:!1}[e]),t},y.dom.get_left_sidebar_links=function(){return _("div[role=navigation] [title]")},y.dom.header=function(){return _("#gb")},y.dom.search_bar=function(){return _("[gh=sb]")},y.get.search_query=function(){return y.dom.search_bar().find("input")[0].value},y.get.unread_inbox_emails=function(){return y.helper.get.navigation_count("inbox")},y.get.unread_draft_emails=function(){return y.helper.get.navigation_count("drafts")},y.get.unread_spam_emails=function(){return y.helper.get.navigation_count("spam")},y.get.unread_forum_emails=function(){return y.helper.get.navigation_count("forums")},y.get.unread_update_emails=function(){return y.helper.get.navigation_count("updates")},y.get.unread_promotion_emails=function(){return y.helper.get.navigation_count("promotions")},y.get.unread_social_emails=function(){return y.helper.get.navigation_count("social_updates")},y.helper.get.navigation_count=function(e){e=y.tools.i18n(e);const t=_("div[role=navigation]").find("[title*='"+e+"']");if((t||0<t.length)&&-1!==t[0].title.indexOf(e)){e=parseInt(t[0].attributes["aria-label"].value.replace(/[^0-9]/g,""));if(!isNaN(e))return e}return 0},y.get.beta=function(){return{new_nav_bar:0===_("#gbz").length}},y.get.unread_emails=function(){return{inbox:y.get.unread_inbox_emails(),drafts:y.get.unread_draft_emails(),spam:y.get.unread_spam_emails(),forum:y.get.unread_forum_emails(),update:y.get.unread_update_emails(),promotions:y.get.unread_promotion_emails(),social:y.get.unread_social_emails()}},y.tools.error=function(e,...t){console.error(e,...t)},y.tools.parse_url=function(e){for(var t=/[?&]([^=#]+)=([^&#]*)/g,r={},a=t.exec(e);a;)r[a[1]]=a[2],a=t.exec(e);return r},y.tools.sleep=function(e){for(var t=(new Date).getTime();!((new Date).getTime()-t>e););},y.tools.multitry=function(e,t,r,a,o,n){if(void 0!==o&&t<=o)return n;o=void 0===o?0:o;n=r();if(a(n))return n;y.tools.sleep(e),y.tools.multitry(e,t,r,a,o+1,n)},y.tools.deparam=function(e,l){for(var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},d={},u={true:!0,false:!1,null:null},t=e.replace(/\+/g," ").split("&"),r=function(e,t){var r,e=e.split("="),a=decodeURIComponent(e[0]),o=d,n=0,i=a.split("]["),s=i.length-1,s=/\[/.test(i[0])&&/\]$/.test(i[s])?(i[s]=i[s].replace(/\]$/,""),(i=i.shift().split("[").concat(i)).length-1):0;if(2===e.length)if(r=decodeURIComponent(e[1]),l&&(r=r&&!isNaN(r)?+r:"undefined"===r?void 0:void 0!==u[r]?u[r]:r),s)for(;n<=s;n++)o=o[a=""===i[n]?o.length:i[n]]=n<s?o[a]||(i[n+1]&&isNaN(i[n+1])?{}:[]):r;else c(d[a])?d[a].push(r):void 0!==d[a]?d[a]=[d[a],r]:d[a]=r;else a&&(d[a]=l?void 0:"")},a=[],o=0;o<t.length;o++)a.push(r(t[o]));return d},y.tools.get_pathname_from_url=function(e){if("undefined"==typeof document)return e;{const t=document.createElement("a");return t.href=e,t.pathname}},y.tools.parse_actions=function(e,t){if("fup"===e.url.act||"fuv"===e.url.act||e.body_is_object)return!(!e.body_is_object||!y.observe.bound("upload_attachment"))&&{upload_attachment:[e.body_params]};e.url.search;var r={},a={tae:"add_to_tasks","rc_^i":"archive",tr:"delete",dm:"delete_message_in_thread",dl:"delete_forever",dc_:"delete_label",dr:"discard_draft",el:"expand_categories",cffm:"filter_messages_like_these",arl:"label",mai:"mark_as_important",mani:"mark_as_not_important",us:"mark_as_not_spam",sp:"mark_as_spam",mt:"move_label",ib:"move_to_inbox",ig:"mute",rd:"read",sd:"save_draft",sm:"send_message",mo:"show_newly_arrived_message",st:"star",cs:"undo_send",ug:"unmute",ur:"unread",xst:"unstar",new_mail:"new_email",poll:"poll",refresh:"refresh",rtr:"restore_message_in_thread",open_email:"open_email",toggle_threads:"toggle_threads"},o=("string"==typeof e.url.ik&&(y.tracker.ik=e.url.ik),"string"==typeof e.url.at&&(y.tracker.at=e.url.at),"string"==typeof e.url.rid&&-1!==e.url.rid.indexOf("mail")&&(y.tracker.rid=e.url.rid),decodeURIComponent(e.url.act)),n=e.body_params,i="string"==typeof n.t?[n.t]:n.t,s=null;switch(o){case"cs":case"ur":case"rd":case"tr":case"sp":case"us":case"ib":case"dl":case"st":case"xst":case"mai":case"mani":case"ig":case"ug":case"dr":case"mt":case"cffm":case"rc_^i":s=[i,e.url,e.body];break;case"arl":case"dc_":s=[i,e.url,e.body,e.url.acn];break;case"sd":s=[i,e.url,n];break;case"tae":case"sm":s=[e.url,e.body,n];break;case"el":s=[e.url,e.body,"1"===n.ex];break;case"dm":case"rtr":case"mo":s=[n.m,e.url,e.body]}return"string"==typeof e.url._reqid&&"tl"===e.url.view&&void 0!==e.url.auto&&(s=[e.url.th,e.url,e.body],y.observe.bound("new_email")&&(r.new_email=s)),"cv"!==e.url.view&&"ad"!==e.url.view||"string"!=typeof e.url.th||"string"!=typeof e.url.search||void 0!==e.url.rid||(s=[e.url.th,e.url,e.body],y.observe.bound("open_email")&&(r.open_email=s)),"cv"!==e.url.view&&"ad"!==e.url.view||"object"!=typeof e.url.th||"string"!=typeof e.url.search||void 0===e.url.rid||(s=[e.url.th,e.url,e.body],y.observe.bound("toggle_threads")&&(r.toggle_threads=s)),"cv"!==e.url.view&&"ad"!==e.url.view||"string"!=typeof e.url.th||"string"!=typeof e.url.search||void 0===e.url.rid||void 0!==e.url.msgs&&(s=[e.url.th,e.url,e.body],y.observe.bound("toggle_threads")&&(r.toggle_threads=s)),"string"==typeof e.url.SID&&"string"==typeof e.url.zx&&-1!==e.body.indexOf("req0_")&&(y.tracker.SID=e.url.SID,s=[e.url,e.body,n],y.observe.bound("poll")&&(r.poll=s)),"string"==typeof e.url.ik&&"string"==typeof e.url.search&&0===e.body.length&&"string"==typeof e.url._reqid&&(s=[e.url,e.body,n],y.observe.bound("refresh")&&(r.refresh=s)),s&&a[o]&&y.observe.bound(a[o])&&(r[a[o]]=s),"POST"===e.method&&(r.http_event=[e]),y.check.is_new_data_layer()&&y.tools.parse_request_payload(e,r),r},y.check.data.is_thread_id=function(e){return e&&"string"==typeof e&&/^thread-[a|f]:/.test(e)},y.check.data.is_thread=function(e){return e&&"object"==typeof e&&e[0]&&y.check.data.is_thread_id(e[0])},y.check.data.is_email_id=function(e){return e&&"string"==typeof e&&-1===e.indexOf("bump-")&&/^msg-[a|f]:/.test(e)},y.check.data.is_email=function(e){return e&&"object"==typeof e&&e[0]&&y.check.data.is_email_id(e[0])},y.check.data.is_email_new=function(e){return e&&e[0]&&y.check.data.is_email_id(e[0])},y.check.data.is_legacy_email_id=function(e){return e&&"string"==typeof e&&/^[0-9a-f]{16,}$/.test(e)},y.check.data.is_action=function(e){return y.check.data.is_first_type_action(e)||y.check.data.is_second_type_action(e)},y.check.data.is_first_type_action=function(e){return e&&e[1]&&Array.isArray(e[1])&&1===e[1].length&&"string"==typeof e[1][0]},y.check.data.is_second_type_action=function(e){return e&&e[2]&&Array.isArray(e[2])&&e[2].length&&"string"==typeof e[2][0]},y.check.data.is_smartlabels_array=function(e){var t;if(!e||!Array.isArray(e)||0===e.length)return!1;for(t of e){if("string"!=typeof t)return!1;if(!/^\^[a-z]+/.test(t))return!1}return!0},y.check.data.is_json_string=function(e){if(!e||"string"!=typeof e)return!1;let t=e.trim();return t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")},y.tools.get_thread_id=function(e){return y.check.data.is_thread(e)&&e[1]},y.tools.get_thread_data=function(e){return e&&e[2]&&"object"==typeof e[2]&&e[2][7]&&"object"==typeof e[2][7]&&e[2][7]},y.tools.get_action=function(e){return y.tools.get_first_type_action(e)||y.tools.get_second_type_action(e)},y.tools.get_first_type_action=function(e){return e&&e[1]&&e[1].join("")},y.tools.get_second_type_action=function(e){return e&&e[2]&&e[2].join("")},y.tools.get_message_ids=function(e){return e&&e[3]&&Array.isArray(e[3])&&e[3]},y.tools.extract_from_graph=function(e,t){const a=[],o=function(e){try{return t(e)}catch(e){return!1}},n=function(e){if(o(e))a.push(e);else for(var t in e){t=e[t];if(o(t))a.push(t);else if(Array.isArray(t))for(var r of t)n(r,e);else"object"==typeof t&&n(t)}};return n(e),a},y.tools.check_event_type=function(e){var t={"^a":"archive","^k":"delete","^x_":"label","^u^us":"read","^u":"unread","^us":"new_email","^o":"open_email"},e=y.tools.get_thread_data(e);if(e&&y.check.data.is_action(e)){const r=y.tools.get_action(e);return r.startsWith("^x_")&&y.check.data.is_first_type_action(e)?t["^x_"]:t[r]}return null},y.tools.parse_fd_bv_contacts=function(e){if(!e||!Array.isArray(e))return[];const t=[];for(var r of e)t.push(y.tools.parse_fd_bv_contact(r));return t},y.tools.parse_fd_bv_is_draft=function(e){try{return Array.isArray(e)?e.includes("^r")&&e.includes("^r_bt"):!1}catch(e){return!1}},y.tools.parse_fd_bv_contact=function(e){try{return{name:e[2],address:e[1]}}catch(e){return null}},y.tools.parse_fd_attachments=function(e){let t=[];if(Array.isArray(e))for(var r of e){var a=r[0][3]||"";t.push({attachment_id:r[0][1],name:a[2],type:a[3],url:y.tools.check_fd_attachment_url(a[1]),size:Number.parseInt(a[4])})}return t},y.tools.parse_fd_embedded_json_attachments=function(e){let t=[];if(Array.isArray(e))for(var r of e)t.push({attachment_id:r[3],name:r[1],type:r[0],url:y.tools.check_fd_attachment_url(r[5]),size:r[2]});return t},y.tools.check_fd_attachment_url=function(e){var t=y.tracker.globals[7];return e=e&&t&&e.indexOf(t)<0?e.replace("/mail/?",t+"?"):e},y.tools.parse_fd_request_html_payload=function(e){let t=null;try{var r;for(r of e[1][5][1])t=(t||"")+r[2][1]}catch(e){}return t},y.tools.parse_fd_embedded_json_content_html=function(e){let t=null;try{var r;for(r of e[8][1])t=(t||"")+r[2][1]}catch(e){}return t},y.tools.parse_fd_request_payload_get_email2=function(e,t){try{const r=e[1][1];return r.filter(e=>e[0]===t)[0]}catch(e){return{}}},y.tools.parse_fd_embedded_json_get_email=function(e,t){try{const r=e[1][4];return r.filter(e=>e[0]===t)[0]}catch(e){return{}}},y.tools.parse_fd_request_payload=function(e){var t,e=e[1];if(!e||!Array.isArray(e))return null;try{const v=[];for(t of e){var r,a=t[0];for(r of t[2]){var o=r[0],n=y.tools.parse_fd_request_payload_get_email2(t,o),i=r[1][34],s=r[1][7],l=r[1][4],c=Number.parseInt(r[1][16]),d=new Date(c),u=y.tools.parse_fd_bv_is_draft(n[3]),_=y.tools.parse_fd_request_html_payload(r),m=y.tools.parse_fd_attachments(r[1][13]),h=r[1][10][16];let e=y.tools.parse_fd_bv_contact(n[1]);e=e||{address:h,name:""};var f=y.tools.parse_fd_bv_contacts(r[1][0]),p=y.tools.parse_fd_bv_contacts(r[1][1]),g=y.tools.parse_fd_bv_contacts(r[1][2]);const b={id:o,is_draft:u,legacy_email_id:i,thread_id:a,smtp_id:s,subject:l,timestamp:c,content_html:_,date:d,from:e,to:f,cc:p,bcc:g,attachments:m};y.cache.debug_xhr_fetch&&(b.$email_node=r,b.$thread_node=t),v.push(b)}}return v}catch(e){return console.warn("Gmail.js encountered an error trying to parse email-data on fd request!",e),null}},y.tools.parse_fd_embedded_json=function(e){var t,e=e[1];if(!e||!Array.isArray(e))return null;try{const v=[];for(t of e){var r,a=t[1][3];for(r of t[1][4]){var o=r[0],n=y.tools.parse_fd_embedded_json_get_email(t,o),i=r[55],s=r[13],l=r[7],c=y.tools.parse_fd_bv_is_draft(r[10]),d=Number.parseInt(r[17]),u=new Date(d),_=y.tools.parse_fd_embedded_json_content_html(r),m=y.tools.parse_fd_embedded_json_attachments(r[11]),h=r[18][16];let e=y.tools.parse_fd_bv_contact(n[1]);e=e||{address:h,name:""};var f=y.tools.parse_fd_bv_contacts(r[2]),p=y.tools.parse_fd_bv_contacts(r[3]),g=y.tools.parse_fd_bv_contacts(r[4]);const b={id:o,is_draft:c,legacy_email_id:i,thread_id:a,smtp_id:s,subject:l,timestamp:d,content_html:_,date:u,from:e,to:f,cc:p,bcc:g,attachments:m};y.cache.debug_xhr_fetch&&(b.$email_node=r,b.$thread_node=t),v.push(b)}}return v}catch(e){return console.warn("Gmail.js encountered an error trying to parse email-data on embedded json!",e),null}},y.tools.parse_bv_request_payload=function(e){var t,e=e[2];if(!e||!Array.isArray(e))return null;try{const _=[];for(t of e){var r,a=t[0][0],o=t[0][3];for(r of t[0][4]){var n=r[0],i=r[55],s=a,l=Number.parseInt(r[17]),c=new Date(l),d=y.tools.parse_fd_bv_is_draft(r[10]),u=[];const m={id:n,is_draft:d,legacy_email_id:i,thread_id:o,smtp_id:"",subject:s,timestamp:l,content_html:"",date:c,from:{address:void 0!==r[1][1]?r[1][1]:"",name:void 0!==r[1][2]?r[1][2]:""},to:[],cc:[],bcc:[],attachments:u};y.cache.debug_xhr_fetch&&(m.$email_node=r,m.$thread_node=t),_.push(m)}}return _}catch(e){return console.warn("Gmail.js encountered an error trying to parse email-data on bv request!",e),null}},y.tools.parse_bv_embedded_json=function(e){var t,e=e[0][0];if(!e||!Array.isArray(e))return null;try{const _=[];for(t of e){var r,a=t[4][0],o=t[4][3];for(r of t[4][4]){var n=r[0],i=r[55],s=a,l=Number.parseInt(r[17]),c=new Date(l),d=y.tools.parse_fd_bv_is_draft(r[10]),u=[];const m={id:n,is_draft:d,legacy_email_id:i,thread_id:o,smtp_id:"",subject:s,timestamp:l,content_html:"",date:c,from:{address:void 0!==r[1][1]?r[1][1]:"",name:void 0!==r[1][2]?r[1][2]:""},to:[],cc:[],bcc:[],attachments:u};y.cache.debug_xhr_fetch&&(m.$email_node=r,m.$thread_node=t),_.push(m)}}return _}catch(e){return console.warn("Gmail.js encountered an error trying to parse email-data on bv request!",e),null}},y.tools.parse_sent_message_html_payload=function(e){let t=null;try{var r;for(r of e[9][2])t=(t||"")+r[2]}catch(e){}return t},y.tools.parse_sent_message_attachments=function(e){let t=[];if(Array.isArray(e))for(var r of e)t.push({id:r[5],name:r[2],type:r[1],url:r[6],size:Number.parseInt(r[3])});return t},y.tools.parse_sent_message_payload=function(e){try{var t=e,r=t[0],a=t[7],o=Number.parseInt(t[6]),n=new Date(o),i=y.tools.parse_sent_message_html_payload(t),s=t[8][6],l=y.tools.parse_sent_message_attachments(t[11]);return{1:r,id:r,subject:a,timestamp:o,content_html:i,ishtml:s,date:n,from:y.tools.parse_fd_bv_contact(t[1]),to:y.tools.parse_fd_bv_contacts(t[2]),cc:y.tools.parse_fd_bv_contacts(t[3]),bcc:y.tools.parse_fd_bv_contacts(t[4]),attachments:l,email_node:e}}catch(e){return console.warn("Gmail.js encountered an error trying to parse sent message!",e),null}},y.tools.parse_sent_message_payload_new=function(e){try{const u=e=>{if(e&&e[1])return{name:e[2]||"",address:e[1]}};var t=e=>Array.isArray(e)?e.map(u).filter(e=>e):[],r=e,a=r[0],o=r[7],n=r[6],i=new Date(n),s=(e=>{let t=null;try{var r;for(r of e[8][1])t=(t||"")+r[1]}catch(e){y.tools.error("Failed to parse html",e)}return t})(r),l=r[8][6],c=(d=r[11],Array.isArray(d)?d.map(e=>({id:e[4],name:e[1],type:e[0],url:e[5],size:Number.parseInt(e[2])})):[]);return{1:a,id:a,subject:o,timestamp:n,content_html:s,ishtml:l,date:i,from:u(r[1]),to:t(r[2]),cc:t(r[3]),bcc:t(r[4]),attachments:c,email_node:e}}catch(e){return console.warn("Gmail.js encountered an error trying to parse sent message!",e),null}var d},y.tools.parse_request_payload=function(t,r,e){const a=y.tools.get_pathname_from_url(t.url_raw);if(e||a){var o,n=(a||"").endsWith("/i/s"),i=(a||"").endsWith("/i/fd");if(e||i||n){i&&(r.load_email_data=[null]);const u=y.tools.extract_from_graph(t,y.check.data.is_thread);for(o of[...y.tools.extract_from_graph(t.body_params,y.check.data.is_email),...y.tools.extract_from_graph(t.body_params,y.check.data.is_email_new)])for(var s in o){let e=o[s];y.check.data.is_smartlabels_array(e)&&(s=y.check.data.is_email_new(o)?y.tools.parse_sent_message_payload_new(o):y.tools.parse_sent_message_payload(o),-1!==e.indexOf("^pfg")?r.send_message=[t.url,t.body,s]:-1<e.indexOf("^scheduled")&&(r.send_scheduled_message=[t.url,t.body,s]))}try{if(Array.isArray(u)&&y.check.data.is_thread(u[0])){var l=y.tools.check_event_type(u[0]);if(l){const _=u.map(e=>y.tools.get_thread_data(e));var c=u.map(e=>y.tools.get_thread_id(e)),d=_.map(e=>y.tools.get_message_ids(e)).reduce((e,t)=>e.concat(t),[]);r[l]=[null,t.url,t.body,d,c]}}}catch(e){console.error("Error: ",e)}}}},y.tools.parse_response=function(t){if(y.check.data.is_json_string(t))try{return JSON.parse(t)}catch(e){}if(t.startsWith("<!DOCTYPE html")||-1!==t.indexOf("display:inline-block"))return[];let r=[];try{for(t=(t=t.replace(/\n/g," ")).substring(t.indexOf("'")+1,t.length);1<t.replace(/\s/g,"").length;){let e=t.substring(0,t.indexOf("[")).replace(/\s/g,"");e=e||t.length;var a=parseInt(e,10)-2+t.indexOf("["),o=t.substring(t.indexOf("["),a),n=JSON.parse(o);r.push(n),t=(t=t.substring(t.indexOf("["),t.length)).substring(o.length,t.length)}}catch(e){}return r},y.tools.parse_attachment_url=function(e){e=e.split(":");return{type:e[0],url:e[2]+":"+e[3]}};function a(e,t){for(var r in t)e[r]=t[r]}function o(){y.tracker.jackPreventionInstalled||(window.addEventListener("click",e=>{const t=(r=e).path?r.path[0]:r.target;var r;if(t&&t!==document.body){const a=t.querySelector(":scope > .gmailjs");a&&(a.click(),e.preventDefault())}}),y.tracker.jackPreventionInstalled=!0)}y.tools.parse_requests=function(e,t){e.url_raw=e.url,e.url=y.tools.parse_url(e.url),"object"==typeof e.body?(e.body_params=e.body,e.body_is_object=!0):y.check.data.is_json_string(e.body)?e.body_params=JSON.parse(e.body):void 0!==e.body?e.body_params=y.tools.deparam(e.body):e.body_params={},"object"!=typeof y.tracker.events&&"object"!=typeof y.tracker.actions&&(y.tracker.events=[],y.tracker.actions=[]),y.tracker.events.unshift(e);t=y.tools.parse_actions(e,t);return"POST"===e.method&&"string"==typeof e.url.act&&y.tracker.actions.unshift(e),50<y.tracker.events.length&&y.tracker.events.pop(),10<y.tracker.actions.length&&y.tracker.actions.pop(),t},y.tools.patch=function(e,t){t(e)},y.tools.cache_email_data=function(e,t){if(null!==e){const o=y.cache;let r=!1;"fd_request_payload"!==t&&"fd_embedded_json"!==t||(r=!0);for(let t of e){(void 0===o.emailIdCache[t.id]||r)&&(o.emailIdCache[t.id]=t,o.emailLegacyIdCache[t.legacy_email_id]=t);let e=o.threadCache[t.thread_id];var a;e||(e={thread_id:t.thread_id,emails:[]},o.threadCache[t.thread_id]=e),0===e.emails.filter(e=>e.id===t.id).length?e.emails.push(t):r&&(a=e.emails.findIndex(e=>e.id===t.id),e.emails[a]=t)}}},y.tools.xhr_watcher=function(){if(!y.tracker.xhr_init){y.instanceId=Symbol("gmail-js-"+(performance||Date).now()),y.tracker.xhr_init=!0;const e=y.helper.get_xhr_window();y.tools.patch(e.XMLHttpRequest.prototype.open,i=>{e.XMLHttpRequest.prototype.open=function(e,t,r,a,o){var n=i.apply(this,arguments);return this.xhrParams={method:e.toString(),url:t.toString()},Object.defineProperty(this,y.instanceId,{value:Object.freeze({method:e.toString(),url:t.toString()})}),n}}),y.tools.patch(e.XMLHttpRequest.prototype.send,r=>{e.XMLHttpRequest.prototype.send=function(e){var a,o,n=!1,t=(this.xhrParams&&(this.xhrParams.body=e,"string"!=typeof this.xhrParams.url&&this[y.instanceId]&&this[y.instanceId].url&&(this.xhrParams.url=this[y.instanceId].url,delete this.xhrParams.url_raw,delete this.xhrParams.body_params),n=y.tools.parse_requests(this.xhrParams,this)),y.observe.trigger("before",n,this)&&(e=y.check.is_new_data_layer()?arguments[0]=this.xhrParams.body_is_object?this.xhrParams.body_params:JSON.stringify(this.xhrParams.body_params):arguments[0]=this.xhrParams.body_is_object?this.xhrParams.body_params:_.param(this.xhrParams.body_params,!0).replace(/\+/g,"%20")),(y.observe.bound(n,"after")||y.check.is_new_data_layer())&&(a=this.onreadystatechange,(o=this).onreadystatechange=function(e){if(this.readyState===this.DONE){if(""===e.target.responseType||"text"===e.target.responseType?o.xhrResponse=y.tools.parse_response(e.target.responseText):o.xhrResponse=e.target.response,y.check.is_new_data_layer()){const r=y.tools.get_pathname_from_url(o.xhrParams.url_raw);var t;!r.endsWith("/i/fd")||null!=(t=y.tools.parse_fd_request_payload(o.xhrResponse))&&(y.tools.cache_email_data(t,"fd_request_payload"),n.load_email_data=[t]),!r.endsWith("/i/bv")||null!=(t=y.tools.parse_bv_request_payload(o.xhrResponse))&&(y.tools.cache_email_data(t,"bv_request_payload"),n.load_email_data=[t])}y.observe.trigger("after",n,o)}a&&a.apply(this,arguments)}),r.apply(this,arguments));return y.observe.trigger("on",n,this),t}})}},y.tools.embedded_data_watcher=function(){var a;y.tracker.embedded_data_init||(y.tracker.embedded_data_init=!0,a=window._GM_setData,window._GM_setData=function(e){var t;if(void 0!==e&&void 0!==e.Cl6csf&&void 0!==e.Cl6csf[0]&&void 0!==e.Cl6csf[0][2]&&(t=y.tools.parse_fd_embedded_json(JSON.parse(e.Cl6csf[0][2])),y.tools.cache_email_data(t,"fd_embedded_json")),void 0!==e&&void 0!==e.a6jdv&&void 0!==e.a6jdv[0]&&void 0!==e.a6jdv[0][2]&&(t=y.tools.parse_bv_embedded_json(JSON.parse(e.a6jdv[0][2])),y.tools.cache_email_data(t,"bv_embedded_json")),void 0!==e&&void 0!==e.sBEv4c)for(var r of e.sBEv4c)"mla"===r[0]&&(y.tracker.mla=r);a(e)})},y.helper.get_xhr_window=function(){if(y.check.is_new_gui())return top;var e=null;return top.document.getElementById("js_frame")?e=top.document.getElementById("js_frame"):t&&(e=t.top.document.getElementById("js_frame")),(e=e||(t?t.top:top)).contentDocument?e.contentDocument.defaultView:e},y.observe.http_requests=function(){return y.tracker.events},y.observe.actions=function(){return y.tracker.actions},y.observe.bind=function(e,t,r){"object"!=typeof y.tracker.watchdog&&(y.tracker.watchdog={before:{},on:{},after:{},dom:{}},y.tracker.bound={}),"object"!=typeof y.tracker.watchdog[e]&&y.tools.error("api.observe.bind called with invalid type: "+e),"dom"!==e&&y.tools.xhr_watcher(),"object"!=typeof y.tracker.watchdog[e][t]&&(y.tracker.watchdog[e][t]=[]),y.tracker.watchdog[e][t].push(r),y.tracker.bound[t]=void 0===y.tracker.bound[t]?1:y.tracker.bound[t]+1,y.tracker.bound[e]=void 0===y.tracker.bound[e]?1:y.tracker.bound[e]+1},y.observe.on=function(e,t,r){if(y.observe.on_dom(e,t))return!0;y.observe.bind("on",e,t),r&&y.observe.after(e,t)},y.observe.before=function(e,t){y.observe.bind("before",e,t)},y.observe.after=function(e,t){y.observe.bind("after",e,t)},y.observe.bound=function(e,r){return"object"==typeof y.tracker.watchdog&&(e?"object"==typeof e?(a=!1,_.each(e,function(e,t){"object"==typeof y.tracker.watchdog[r][e]&&(a=!0)}),a):r?"object"==typeof y.tracker.watchdog[r][e]:0<y.tracker.bound[e]:r?0<y.tracker.bound[r]:void y.tools.error("api.observe.bound called with invalid args"));var a},y.observe.off=function(t,e){if("object"!=typeof y.tracker.watchdog)return!0;_.each(e?[e]:["before","on","after","dom"],function(e,r){if("object"!=typeof y.tracker.watchdog[r])return!0;t?"object"==typeof y.tracker.watchdog[r][t]&&(y.tracker.bound[t]-=y.tracker.watchdog[r][t].length,y.tracker.bound[r]-=y.tracker.watchdog[r][t].length,delete y.tracker.watchdog[r][t]):_.each(y.tracker.watchdog[r],function(e,t){"object"==typeof y.tracker.watchdog[r][e]&&(y.tracker.bound[e]-=y.tracker.watchdog[r][e].length,y.tracker.bound[r]-=y.tracker.watchdog[r][e].length,delete y.tracker.watchdog[r][e])})})},y.observe.trigger=function(t,e,a){if(!e)return!1;var o=!1;return _.each(e,function(e,r){r=_.extend([],r),"after"===t&&r.push(a.xhrResponse),r.push(a),y.observe.bound(e,t)&&(o=!0,_.each(y.tracker.watchdog[t][e],function(e,t){t.apply(void 0,r)}))}),o},y.observe.trigger_dom=function(e,r,a){a=a||function(e,t){t(e)},y.tracker.watchdog.dom[e]&&_.each(y.tracker.watchdog.dom[e],function(e,t){a(r,t)})},y.observe.initialize_dom_observers=function(){y.tracker.dom_observer_init=!0,y.tracker.supported_observers=["view_thread","view_email","load_email_menu","recipient_change","compose"],y.tracker.dom_observers={view_thread:{class:["Bu","nH"],sub_selector:"div.if,div.iY",handler:function(e,t){t(e=new y.dom.thread(e))}},view_email:{class:["Bu","nH",""],sub_selector:"div.adn",handler:function(e,t){t(e=new y.dom.email(e))}},load_email_menu:{class:"J-N",selector:"div[role=menu] div[role=menuitem]:first-child",handler:function(e,t){t(e=e.closest("div[role=menu]"))}},recipient_change:{class:["vR","afV"],handler:function(a,o){"object"!=typeof y.tracker.recipient_matches&&(y.tracker.recipient_matches=[]),y.tracker.recipient_matches.push(a),setTimeout(function(){if(y.tracker.recipient_matches.length){let t=[];y.tracker.recipient_matches.forEach(e=>{0===t.length&&(t=e.closest("div.M9"))}),0===t.length&&y.tools.error("Can't find composeRoot for "+a);var e=new y.dom.compose(t),r=e.recipients();o(e,r,y.tracker.recipient_matches),y.tracker.recipient_matches=[]}},100)}},compose:{class:"An",handler:function(e,t){var r=e;(e=e.closest("div.M9")).length&&((e=new y.dom.compose(e)).is_inline()||r.closest("div.AD").find(".Ha").mouseup(function(){return y.tracker.composeCancelledCallback&&y.tracker.composeCancelledCallback(e),!0}),t(e,e.type()))}}},y.tracker.custom_supported_observers&&(_.merge(y.tracker.supported_observers,y.tracker.custom_supported_observers),_.extend(!0,y.tracker.dom_observers,y.tracker.custom_dom_observers)),y.tracker.dom_observer_map={},_.each(y.tracker.dom_observers,function(r,e){_.isArray(e.class)||(e.class=[e.class]),_.each(e.class,function(e,t){y.tracker.dom_observer_map[t]||(y.tracker.dom_observer_map[t]=[]),y.tracker.dom_observer_map[t].push(r)})})},y.observe.register=function(e,r){y.tracker.dom_observer_init&&y.tools.error("Error: Please register all custom DOM observers before binding handlers using gmail.observe.on etc"),y.tracker.custom_supported_observers||(y.tracker.custom_supported_observers=[],y.tracker.custom_dom_observers={});var a={};"object"!=typeof r||_.isArray(r)?a.class=r:_.each(["class","selector","sub_selector","handler"],function(e,t){r[t]&&(a[t]=r[t])}),y.tracker.custom_supported_observers.push(e),y.tracker.custom_dom_observers[e]=a};function n(e,t,r,a,o,n){var i=_(document.createElement("div")),s=(i.attr("class","G-Ni J-J5-Ji"),_(document.createElement("div"))),l="T-I J-J5-Ji gmailjs ";return s.attr("class",l+=null!=o&&""!==o?r+o:r+a),s.html(e),s.click(t),_(document.createElement("div")).attr("class","asa"),i.html(s),n.append(i),i}y.observe.on_dom=function(e,t){if(y.tracker.dom_observer_init||y.observe.initialize_dom_observers(),-1<_.inArray(e,y.tracker.supported_observers))return y.tracker.observing_dom||(y.tracker.observing_dom=!0,_(window.document).on("DOMNodeInserted",function(e){y.tools.insertion_observer(e.target,y.tracker.dom_observers,y.tracker.dom_observer_map)}),new MutationObserver(function(e){for(var t=0;t<e.length;t++)for(var r=e[t],a=r.removedNodes,o=0;o<a.length;o++){var n,i,s=a[o];"agh"===s.className&&s.querySelector("div[data-hovercard-id]")?(n=y.tracker.dom_observer_map.afV,i=y.tracker.dom_observers.recipient_change.handler,y.observe.trigger_dom(n,_(r.target),i)):"vR"===s.className&&(n=y.tracker.dom_observer_map.vR,i=y.tracker.dom_observers.recipient_change.handler,y.observe.trigger_dom(n,_(r.target),i))}}).observe(document.body,{subtree:!0,childList:!0})),y.observe.bind("dom",e,t),!0;if("compose_cancelled"===e)y.tracker.composeCancelledCallback=t;else if("load"===e){if(y.dom.inbox_content().length)return o(),t();var r=0,a=setInterval(function(){if(0<y.dom.inbox_content().length)return clearInterval(a),o(),t();50<++r&&(clearInterval(a),setTimeout(t,5e3))},200);return!0}},y.tools.insertion_observer=function(n,i,s,e){var t;s&&((t=(t=n.className||"").trim?t.trim().split(/\s+/):[]).length||t.push(""),_.each(t,function(e,t){t=s[t];if(t)for(var r of t)if(r&&y.tracker.watchdog&&y.tracker.watchdog.dom[r]){var a=_(n),o=i[r];if(o.selector&&!a.is(o.selector))return;(a=o.sub_selector?a.find(o.sub_selector):a).length&&(o=o.handler||function(e,t){t(e)},y.observe.trigger_dom(r,a,o))}}))},y.tools.make_request=function(e,t,r){e=decodeURIComponent(e.replace(/%23/g,"#-#-#")),t={type:t=t||"GET",url:encodeURI(e).replace(/#-#-#/gi,"%23"),async:!1,dataType:"text"};return r&&(t.cache=!1),_.ajax(t).responseText},y.tools.make_request_async=function(e,t,a,o,r){e=decodeURIComponent(e.replace(/%23/g,"#-#-#")),t={type:t=t||"GET",url:encodeURI(e).replace(/#-#-#/gi,"%23"),async:!0,dataType:"text"};r&&(t.cache=!1),_.ajax(t).done(function(e,t,r){a(r.responseText)}).fail(function(e,t,r){console.error("Request Failed",r),"function"==typeof o&&o(e,t,r)})},y.tools.make_request_download_promise=function(e,o){var t=Date.now();e+="&cacheCounter="+t;let n=o?"arraybuffer":"text";return new Promise((r,t)=>{const a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType=n,a.onreadystatechange=()=>{var e,t;a.readyState===XMLHttpRequest.DONE&&200<=a.status&&a.status<=302&&(e=a.response)&&(o?(t=new Uint8Array(e),r(t)):r(e))},a.onerror=e=>{t(e)},a.send()})},y.tools.parse_view_data=function(e){for(var t=[],r=[],a=0;a<e.length;a++)if("tb"===e[a][0])for(var o=0;o<e[a][2].length;o++)r.push(e[a][2][o]);for(var n=0;n<r.length;n++){var i=r[n];t.push({id:i[0],title:i[9],excerpt:i[10],time:i[15],sender:i[28],attachment:i[13],labels:i[5]})}return t},y.helper.get.is_delegated_inbox=function(){return 1===_(".gb_Da").length},y.helper.get.visible_emails_pre=function(e){var t,r=y.get.current_page(),a=window.location.origin+window.location.pathname+"?ui=2&ik="+y.tracker.ik+"&rid="+y.tracker.rid+"&view=tl&num=120&rt=1",o=_(".aqK:visible .Dj").find("span:first").text().replace(",","").replace(".","").split("–")[0],o=(a+=o?"&start="+(o=parseInt(o-1))+"&sstart="+o:"&start=0","");return 0===r.indexOf("label/")?a+="&cat="+r.split("/")[1]+"&search=cat":0===r.indexOf("category/")?(-1!==r.indexOf("forums")?o="group":-1!==r.indexOf("updates")?o="notification":-1!==r.indexOf("promotion")?o="promo":-1!==r.indexOf("social")&&(o="social"),a+="&cat=^smartlabel_"+o+"&search=category"):0===r.indexOf("search/")?(t=_("input[name=at]").val(),a+="&qs=true&q="+r.split("/")[1]+"&at="+t+"&search=query"):"inbox"===r?"true"===_("div[aria-label='Social']").attr("aria-selected")?a+="&cat=^smartlabel_"+(o="social")+"&search=category":"true"===_("div[aria-label='Promotions']").attr("aria-selected")?a+="&cat=^smartlabel_"+(o="promo")+"&search=category":"true"===_("div[aria-label='Updates']").attr("aria-selected")?a+="&cat=^smartlabel_"+(o="notification")+"&search=category":"true"===_("div[aria-label='Forums']").attr("aria-selected")?a+="&cat=^smartlabel_"+(o="group")+"&search=category":e?a+="&search="+e:y.check.is_google_apps_user()?a+="&search=inbox":a+="&search=mbox":a+="&search="+r,a},y.helper.get.visible_emails_post=function(e){var t=[];if(!e)return t;var r,e=e.substring(e.indexOf("["),e.length),e=JSON.parse(e);for(r in y.tracker.view_data=e,y.tracker.view_data)if("function"!=typeof y.tracker.view_data[r]){var a=y.tools.parse_view_data(y.tracker.view_data[r]);if(0<a.length){s=i=n=o=void 0;for(var o=t,n=a,i=0;i<n.length;i++){var s=n[i];o.push(s)}}}return t},y.get.visible_emails=function(e){e=y.helper.get.visible_emails_pre(e),e=y.tools.make_request(e);return y.helper.get.visible_emails_post(e)},y.get.visible_emails_async=function(t,e){e=y.helper.get.visible_emails_pre(e);y.tools.make_request_async(e,"GET",function(e){e=y.helper.get.visible_emails_post(e);t(e)})},y.get.selected_emails_data=function(e){var t,r,a=[];return y.check.is_inside_email()?a.push(y.get.email_data()):_("[gh='tl'] div[role='checkbox'][aria-checked='true']").length&&(t=null,r=y.get.visible_emails(e),_("[gh='tl'] div[role='checkbox']").each(function(e){"true"===_(this).attr("aria-checked")&&(t=y.get.email_data(r[e].id),a.push(t))})),a},y.get.current_page=function(e){e=(e=e||window.location.hash).split("#").pop().split("?").shift()||"inbox";if(e.match(/\/[0-9a-zA-Z]{16,}$/gi))return"email";var t;return 0===e.indexOf("search/")||0===e.indexOf("category/")||0===e.indexOf("label/")?(t=e.split("/"))[0]+"/"+t[1]:e.split("/").shift()},y.tools.infobox=function(e,t,r){var a,o,n=_(".b8.UC");0<n.length&&(n.stop(!1,!0),a=n.find(".vh"),r?a.html(e):a.text(e),void 0!==t?(o=n.attr("style"),n.removeAttr("style").fadeTo(t,0,function(){_(this).attr("style",o)})):n.removeAttr("style"))},y.tools.rerender=function(e){var t=window.location.href,r=-1!==window.location.hash.indexOf("/")?t.replace(/#.*?\//,"#/"):t.replace(/#.*/,"#");window.location.replace(r),setTimeout(function(){window.location.replace(t),window.history.back(),e&&e()},0)},y.tools.get_reply_to=function(e){e=e?e[4]:[];return 0!==e.length?y.tools.extract_email_address(e[0]):null},y.tools.parse_attachment_data=function(e){if(!e[7]||!e[7][0])return null;for(var t="",r=("undefined"!=typeof window&&(t=window.location.origin+window.location.pathname),e[7][0]),a=(y.tracker.attachment_data=r,[]),o=0;o<r.length;o++){var n=r[o];a.push({attachment_id:n[0],name:n[1],type:n[2],size:n[3],url:t+n[9]})}return a},y.tools.parse_email_data=function(e){var t,r={};for(t in e){var a=e[t];if("cs"===a[0]&&(r.thread_id=a[1],r.first_email=a[8][0],r.last_email=a[2],r.total_emails=a[3],r.total_threads=a[8],r.people_involved=a[15],r.subject=a[23]),"ms"===a[0]){void 0===r.threads&&(r.threads={}),r.threads[a[1]]={},r.threads[a[1]].is_deleted=a[9]&&-1<a[9].indexOf("^k"),r.threads[a[1]].reply_to_id=a[2],r.threads[a[1]].from=a[5],r.threads[a[1]].from_email=a[6],r.threads[a[1]].timestamp=a[7],r.threads[a[1]].datetime=a[24],r.threads[a[1]].attachments=a[21].split(","),r.threads[a[1]].attachments_details=a[13]?y.tools.parse_attachment_data(a[13]):null,r.threads[a[1]].subject=a[12],r.threads[a[1]].content_html=a[13]?a[13][6]:a[8],r.threads[a[1]].to=a[13]?a[13][1]:void 0!==a[37]?a[37][1]:[],r.threads[a[1]].cc=a[13]?a[13][2]:[],r.threads[a[1]].bcc=a[13]?a[13][3]:[],r.threads[a[1]].reply_to=y.tools.get_reply_to(a[13]),r.threads[a[1]].labels=a[9];try{r.threads[a[1]].content_plain=a[13]?_(a[13][6]).text():a[8]}catch(e){r.threads[a[1]].content_plain=a[13]?a[13][6]:a[8]}}}return r},y.helper.get.email_data_pre=function(e){r("Migrate code to use gmail.new.get.email_data() to fix this problem.");var t=null;return t=void 0!==(e=y.check.is_inside_email()&&void 0===e?y.get.thread_id():e)?window.location.origin+window.location.pathname+"?ui=2&ik="+y.tracker.ik+"&rid="+y.tracker.rid+"&view=cv&th="+e+"&msgs=&mb=0&rt=1&search=inbox":t},y.helper.get.email_data_post=function(e){if(!e)return{};e=e.substring(e.indexOf("["),e.length),e=JSON.parse(e);return y.tracker.email_data=e[0],y.tools.parse_email_data(y.tracker.email_data)},y.get.email_data=function(e){var e=y.helper.get.email_data_pre(e);return null!==e?(e=y.tools.make_request(e),y.helper.get.email_data_post(e)):{}},y.get.email_data_async=function(e,t){e=y.helper.get.email_data_pre(e);null!==e?y.tools.make_request_async(e,"GET",function(e){e=y.helper.get.email_data_post(e);t(e)}):t({})},y.helper.get.legacy_email_id=function(e){return e?y.check.data.is_legacy_email_id(e)?e:e.legacy_email_id||(y.check.data.is_email_id(e)?(console.warn("GmailJS: Warning! Using new-style ID in method expecting legacy-style IDs! Attempting to resolve via cache, but there's no guarantee this will work!"),(t=y.cache.emailIdCache[e])&&t.legacy_email_id):(e=e.$el&&e.$el[0]?e.$el[0]:e).dataset&&e.dataset.legacyMessageId?e.dataset.legacyMessageId:null):null;var t},y.helper.get.new_email_id=function(t){if(!t)return null;if(y.check.data.is_email_id(t))return t;if(t.id&&!t.$el)return t.id;var e;if(y.check.data.is_legacy_email_id(t))return console.warn("GmailJS: Warning! Using legacy-style ID in method expecting new-style IDs! Attempting to resolve via cache, but there's no guarantee this will work!"),(e=y.cache.emailLegacyIdCache[t])&&e.id;if((t=t.$el&&t.$el[0]?t.$el[0]:t).dataset&&t.dataset.messageId){let e=t.dataset.messageId;return e=0===e.indexOf("#")?e.substring(1):e}return null},y.helper.get.thread_id=function(t){if(!t)return null;if(y.check.data.is_thread_id(t))return t;if(t.thread_id)return t.thread_id;if(y.check.data.is_email_id(t))return console.warn("GmailJS: Warning! Using email-ID in method expecting thread-ID! Attempting to resolve via cache, but there's no guarantee this will work!"),(r=y.cache.emailIdCache[t])&&r.thread_id;if(y.check.data.is_legacy_email_id(t))return console.warn("GmailJS: Warning! Using legacy-style ID in method expecting thread-ID! Attempting to resolve via cache, but there's no guarantee this will work!"),(r=y.cache.emailLegacyIdCache[t])&&r.thread_id;if((t=t.$el&&t.$el[0]?t.$el[0]:t).dataset&&t.dataset.threadPermId){let e=t.dataset.threadPermId;return e=0===e.indexOf("#")?e.substring(1):e}if(t.dataset&&t.dataset.messageId){let e=t.dataset.messageId;0===e.indexOf("#")&&(e=e.substring(1)),console.warn("GmailJS: Warning! Using DomEmail instance to lookup thread-ID. Attempting to resolve via cache, but there's no guarantee this will work!");var r=y.cache.emailIdCache[e];return r&&r.thread_id}return null},y.helper.clean_thread_id=function(e){return e=e.startsWith("#")?e.substring(1):e},y.helper.get.email_source_pre=function(e){if(!e&&y.check.is_inside_email()&&(e=y.get.email_id()),y.check.data.is_legacy_email_id(e))return window.location.origin+window.location.pathname+"?view=att&th="+e+"&attid=0&disp=comp&safe=1&zw";e=y.helper.get.new_email_id(e);return e?window.location.origin+window.location.pathname+"?view=att&permmsgid="+e+"&attid=0&disp=comp&safe=1&zw":null},y.get.email_source=function(e){console.warn("Gmail.js: This function has been deprecated and will be removed in an upcoming release! Please migrate to email_source_async or email_source_promise!");e=y.helper.get.email_source_pre(e);return null!==e?y.tools.make_request(e,"GET",!0):""},y.get.email_source_async=function(e,t,r,a){y.get.email_source_promise(e,a).then(t).catch(r)},y.get.email_source_promise=function(e,t){e=y.helper.get.email_source_pre(e);return null!==e?y.tools.make_request_download_promise(e,t):new Promise((e,t)=>{t("Unable to resolve URL for email source!")})},y.get.displayed_email_data=function(){var e=y.get.email_data();return(y.check.is_conversation_view()?i:s)(e)},y.get.displayed_email_data_async=function(t){y.get.email_data_async(void 0,function(e){y.check.is_conversation_view()?t(i(e)):t(s(e))})};var i=function(e){var t,r=e,a=r.threads,o=r.total_threads,n=0===(window.location.hash.split("#")[1]||"").indexOf("trash");for(t in a){var i=a[t];(n?i.is_deleted:!i.is_deleted)||(delete a[t],o.splice(o.indexOf(t),1),r.total_emails--)}return r},s=function(e){var t,r={};for(t in e.threads)if(document.querySelector("div[data-legacy-message-id='"+t+"']")){var a=e.threads[t];r.first_email=t,r.last_email=t,r.subject=e.subject,r.threads={},r.threads[t]=a,r.total_emails=1,r.total_threads=[t],r.people_involved=[],r.people_involved.push([a.from,a.from_email]),a.to.forEach(function(e){var t=y.tools.extract_email_address(e),e=y.tools.extract_name(e.replace(t,""))||"";r.people_involved.push([e,t])});break}return r};y.check.is_conversation_view=function(){if(y.check.is_new_data_layer())return-1!==y.tracker.globals[24].indexOf(7164);for(var e=void 0,t=y.tracker.globals[17][4][1],r=0;r<t.length;r++){var a=t[r];if("bx_vmb"===a[0]){e=a[1];break}}return"0"===e||void 0===e},y.tools.extract_email_address=function(e){e=e?e.match(/[\+a-z0-9._-]+@[a-z0-9._-]+\.[a-z0-9._-]+/gi):void 0;return e?e[0]:void 0},y.tools.extract_name=function(e){e=e?e.match(/[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF"._\s-]+/gi):void 0;return e&&e[0]?e[0].trim():void 0},y.tools.i18n=function(e){var t;switch(y.get.localization()){case"fr":t={inbox:"Boîte de réception",drafts:"Brouillons",spam:"Spam",forums:"Forums",updates:"Mises à jour",promotions:"Promotions",social_updates:"Réseaux sociaux"};break;case"no":t={inbox:"Innboks",drafts:"Utkast",spam:"Søppelpost",forums:"Forumer",updates:"Oppdateringer",promotions:"Reklame",social_updates:"Sosialt"};break;case"nl":t={inbox:"Postvak IN",drafts:"Concepten",spam:"Spam",forums:"Forums",updates:"Updates",promotions:"Reclame",social_updates:"Sociaal"};break;case"it":t={inbox:"Posta in arrivo",drafts:"Bozza",spam:"Spam",forums:"Forum",updates:"Aggiornamenti",promotions:"Promozioni",social_updates:"Social"};break;default:t={inbox:"Inbox",drafts:"Drafts",spam:"Spam",forums:"Forums",updates:"Updates",promotions:"Promotions",social_updates:"Social Updates"}}return t[e]};return y.tools.add_toolbar_button=function(e,t,r){return n(e,t,"lS ","T-I-ax7 ar7",r,y.dom.toolbar())},y.tools.add_right_toolbar_button=function(e,t,r){return n(e,t,"ash ","T-I-ax7 L3",r,y.dom.right_toolbar())},y.tools.add_compose_button=function(e,t,r,a){var o=_(document.createElement("div")),n=(o.attr("class","gU Up"),o.attr("style","cursor: pointer !important; transform: translateY(1px);"),_(document.createElement("div"))),i="T-I J-J5-Ji aoO T-I-atl L3 gmailjs gmailjscomposebutton ",a=(void 0!==a&&(i+=a),n.attr("class",i),n.attr("style","margin-left: 8px; max-width: 500px;"),n.html(t),n.click(r),o.append(n),e.find(".gU.Up").last());return o.insertAfter(a),n},y.tools.add_more_send_option=function(e,t,r,a,o){var n=_(document.createElement("div")),i=(n.attr("class","J-N yr"),n.attr("style","user-select: none;"),n.attr("role","menuitem"),_(document.createElement("div"))),s="J-N-Jz ",a=(void 0!==a&&(s+=a),i.attr("class",s),i.attr("style","user-select: none;"),_(document.createElement("img"))),s="J-N-JX",o=(a.attr("class",s=void 0!==o?o+" "+s:s),a.attr("style","user-select: none;"),a.attr("role","menuitem"),a.attr("src","images/cleardot.gif"),i.append(a),i.append(t),i.click(r),n.append(i),e.find(".J-N.yr").last());return n.insertAfter(o),i},y.tools.add_attachment_button=function(e,t,r,a,o){var n=_(document.createElement("div")),a=(n.attr("class","T-I J-J5-Ji aQv T-I-ax7 L3"),n.attr("style","user-select: none;"),n.attr("aria-label",a),n.attr("data-tooltip",a),n.mouseover(function(){this.classList.add("T-I-JW")}),n.mouseout(function(){this.classList.remove("T-I-JW")}),_(document.createElement("div"))),i="wtScjd J-J5-Ji aYr";return r&&(i+=" "+r),a.attr("class",i),t&&a.html(t),n.append(a),n.click(o),e.$el.find("div.aQw").append(n),n},y.tools.remove_modal_window=function(){_("#gmailJsModalBackground").remove(),_("#gmailJsModalWindow").remove()},y.tools.add_modal_window=function(e,t,r,a,o,n,i){o=o||y.tools.remove_modal_window,a=a||y.tools.remove_modal_window,n=n||"OK",i=i||"Cancel";function s(){c.css({top:(_(window).height()-c.outerHeight())/2,left:(_(window).width()-c.outerWidth())/2})}var l=_(document.createElement("div")),c=(l.attr("id","gmailJsModalBackground"),l.attr("class","Kj-JD-Jh"),l.attr("aria-hidden","true"),l.attr("style","opacity:0.75;width:100%;height:100%;"),_(document.createElement("div"))),d=(c.attr("id","gmailJsModalWindow"),c.attr("class","Kj-JD"),c.attr("tabindex","0"),c.attr("role","alertdialog"),c.attr("aria-labelledby","gmailJsModalWindowTitle"),c.attr("style","left:50%;top:50%;opacity:1;"),_(document.createElement("div"))),u=(d.attr("class","Kj-JD-K7 Kj-JD-K7-GIHV4"),_(document.createElement("span"))),e=(u.attr("id","gmailJsModalWindowTitle"),u.attr("class","Kj-JD-K7-K0"),u.attr("role","heading"),u.html(e),_(document.createElement("span"))),o=(e.attr("id","gmailJsModalWindowClose"),e.attr("class","Kj-JD-K7-Jq"),e.attr("role","button"),e.attr("tabindex","0"),e.attr("aria-label","Close"),e.click(o),d.append(u),d.append(e),_(document.createElement("div"))),u=(o.attr("id","gmailJsModalWindowContent"),o.attr("class","Kj-JD-Jz"),o.html(t),_(document.createElement("div"))),e=(u.attr("class","Kj-JD-Jl"),_(document.createElement("button"))),t=(e.attr("id","gmailJsModalWindowOk"),e.attr("class","J-at1-auR J-at1-atl"),e.attr("name","ok"),e.text(n),e.click(r),_(document.createElement("button")));t.attr("id","gmailJsModalWindowCancel"),t.attr("name","cancel"),t.text(i),t.click(a),u.append(e),u.append(t),c.append(d),c.append(o),c.append(u),_(document.body).append(l),_(document.body).append(c);s(),c.on("DOMSubtreeModified",s),_(window).resize(s)},y.tools.toggle_minimize=function(){var e=_("[alt='Minimize']")[0];return!!e&&(e.click(),!0)},y.chat.is_hangouts=function(){if(void 0!==y.tracker.hangouts)return y.tracker.hangouts;var e=_(".dw");if(1<e.length)throw"Figuring out is hangouts - more than one dw classes found";if(0===e.length)throw"Figuring out is hangouts - no dw classes found";e=e[0];return 0<_(".nH.aJl.nn",e).length?y.tracker.hangouts=!0:2<_(".nH.nn",e).length?y.tracker.hangouts=!1:void 0},y.dom.visible_messages=function(){const n=[];return _('tbody>tr.zA[role="row"]:visible',y.dom.inbox_content()).each((e,t)=>{const r=_("*[email][name]",t);var a=_("*[role=link]",t),o=t.querySelector("span[data-thread-id]");n.push({from:{name:r.attr("name"),email:r.attr("email")},summary:a[0].innerText,thread_id:y.helper.clean_thread_id(o&&o.dataset&&o.dataset.threadId||""),legacy_email_id:o&&o.dataset&&o.dataset.legacyMessageId||"",$el:_(t)})}),n},y.dom.composes=function(){var r=[];return _("div.M9").each(function(e,t){r.push(new y.dom.compose(t))}),r},y.dom.helper={},y.dom.helper.trigger_address=function(e){let t=e[0];e=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Tab",shiftKey:!0,keyCode:9});t.focus(),t.dispatchEvent(e)},y.dom.compose=function(e){return this.constructor!==y.dom.compose?new y.dom.compose(e):((e=_(e))&&(e.hasClass("M9")||e.hasClass("AD"))||y.tools.error("api.dom.compose called with invalid element"),this.$el=e,this)},a(y.dom.compose.prototype,{id:function(){return this.dom("id").val()},email_id:function(){let e=this.dom("draft").val();return e&&e.startsWith("#")?e.substring(1):e},thread_id:function(){var e=this.dom("thread").val()||"";return y.helper.clean_thread_id(e)},is_inline:function(){return 0<this.$el.closest("td.Bu").length},type:function(){return this.is_inline()?0===this.find("input[name=subject]").val().indexOf("Fw")?"forward":"reply":"compose"},recipients:function(r){"object"!=typeof r&&(r={});var e=y.check.is_peoplekit_compose(this.$el),t=r.type?"[name="+r.type+"]":"";const a=e?this.$el.find("tr.bzf "+(t||"div[name]")+" div[data-hovercard-id]").map((e,t)=>({type:r.type||t.closest("div[name]").getAttribute("name"),email:t.getAttribute("data-hovercard-id")})):this.$el.find(".GS input[type=hidden]"+t).map((e,t)=>({type:t.name,email:t.value}));if(r.flat)return a.toArray().map(e=>e.email);{let e={to:[],cc:[],bcc:[]};return r.type?e[r.type]=a.toArray().filter(e=>e.type===r.type).map(e=>e.email):["to","cc","bcc"].forEach(t=>{e[t]=a.toArray().filter(e=>e.type===t).map(e=>e.email)}),e}},to:function(e){e=this.dom("to").val(e);return y.dom.helper.trigger_address(e),e},cc:function(e){if(e){const t=this.dom("show_cc");t.click()}e=this.dom("cc").val(e);return y.dom.helper.trigger_address(e),e},bcc:function(e){if(e){const t=this.dom("show_bcc");t.click()}e=this.dom("bcc").val(e);return y.dom.helper.trigger_address(e),e},subject:function(e){return e&&this.dom("all_subjects").val(e),(e=this.dom("subjectbox").val())||this.dom("subject").val()},from:function(){var e=this.dom("from");if(e.length){e=e.val();if(e)return y.tools.extract_email_address(e)}return y.get.user_email()},body:function(e){var t=this.dom("body");return e&&t.html(e),t.html()},attachments:function(){var r=[];return this.dom("attachments").each(function(){var e=_(this),t={};t.$el=e,t.name=e.find("div.vI").html(),t.size=e.find("div.vJ").html(),t.url=e.find("a.dO").attr("href"),t.type="https",r.push(t)}),r},send:function(){return this.dom("send_button").click()},find:function(e){return this.$el.find(e)},close:function(){const e=document.createEvent("Events");e.initEvent("keydown",!0,!0),e.which=27,e.keyCode=27;var t=this.dom("body");t.focus(),t[0].dispatchEvent(e)},dom:function(e){if(!e)return this.$el;var t={to:"textarea[name=to]",cc:"textarea[name=cc]",bcc:"textarea[name=bcc]",id:"input[name=composeid]",draft:"input[name=draft]",thread:"input[name=rt]",subject:"input[name=subject]",subjectbox:"input[name=subjectbox]",all_subjects:"input[name=subjectbox], input[name=subject]",body:"div[contenteditable=true]:not([id=subject])",quoted_reply:"input[name=uet]",reply:"M9",forward:"M9",from:"input[name=from]",attachments:"div.dL",send_button:"div.T-I.T-I-atl:not(.gmailjscomposebutton)",show_cc:"span.aB.gQ.pE",show_bcc:"span.aB.gQ.pB"};return(t=y.check.is_peoplekit_compose(this.$el)?Object.assign(t,{to:"div[name=to] input",cc:"div[name=cc] input",bcc:"div[name=bcc] input"}):t)[e]||y.tools.error('Dom lookup failed. Unable to find config for "'+e+'"',t,e,t[e]),this.$el.find(t[e])}}),y.dom.email=function(e){return this.constructor!==y.dom.email?new y.dom.email(e):("string"==typeof e&&y.check.data.is_legacy_email_id(e)?(this.id=e,this.$el=_("div.adn[data-legacy-message-id='"+this.id+"']")):"string"==typeof e&&y.check.data.is_email_id(e)?(t=document.querySelector("div.adn[data-message-id='"+e.replace("msg-f:","\\#msg-f\\:")+"']"),this.id=t.dataset.legacyMessageId,this.$el=_(t)):e&&(e.classList&&e.classList.contains("adn")||e.hasClass&&e.hasClass("adn"))?(this.$el=_(e),this.id=this.$el.data("legacyMessageId")):y.tools.error("api.dom.email called with invalid element/id"),this);var t},a(y.dom.email.prototype,{body:function(e){var t=this.dom("body");return e&&t.html(e),t.html()},from:function(e,t){var r=this.dom("from");return e&&r.attr("email",e),t&&(r.attr("name",t),r.html(t)),{email:r.attr("email"),name:r.attr("name"),el:r}},to:function(e){e&&(_.isArray(e)||(e=[e]),r=[],_.each(e,function(e,t){r.push(_("<span />").attr({dir:"ltr",email:t.email,name:t.name}).addClass("g2").html(t.name).wrap("<p/>").parent().html())}),this.dom("to_wrapper").html("to "+r.join(", ")));var r,t=[];return this.dom("to").each(function(){var e=_(this);t.push({email:e.attr("email"),name:e.attr("name"),el:e})}),t},attachments:function(){var r=[];return this.dom("attachments").each(function(){var e=_(this),t={},e=(t.$el=e,t.name=e.find(".aV3").html(),t.size=e.find(".SaH2Ve").html(),e.attr("download_url"));e&&(e=y.tools.parse_attachment_url(e),t.url=e.url,t.type=e.type),r.push(t)}),r},data:function(){var e;return"object"!=typeof y.dom.email_cache&&(y.dom.email_cache={}),y.dom.email_cache[this.id]||(e=y.get.email_data(this.id),_.each(e.threads,function(e,t){y.dom.email_cache[e]=t})),y.dom.email_cache[this.id]},source:function(){return y.get.email_source(this.id)},dom:function(e){if(!e)return this.$el;var t={body:"div.a3s",from:"span[email].gD",to:"span[email].g2",to_wrapper:"span.hb",timestamp:"span.g3",star:"div.zd",attachments:"div.hq.gt div.aQH span.aZo",reply_button:"div[role=button].aaq",menu_button:"div[role=button].aap",details_button:"div[role=button].ajz"};return t[e]||y.tools.error('Dom lookup failed. Unable to find config for "'+e+'"'),this.$el.find(t[e])}}),y.dom.thread=function(e){return this.constructor!==y.dom.thread?new y.dom.thread(e):(e&&(e.hasClass("if")||e.hasClass("iY"))||y.tools.error("api.dom.thread called with invalid element/id"),this.$el=e,this)},a(y.dom.thread.prototype,{dom:function(e){if(!e)return this.$el;var t={opened_email:"div.adn",subject:"h2.hP",labels:"div.hN"};return t[e]||y.tools.error('Dom lookup failed. Unable to find config for "'+e+'"'),this.$el.find(t[e])}}),y.compose.start_compose=function(){var e=document.getElementsByClassName("T-I T-I-KE L3")[0];return!!e&&(e.click(),!0)},y.old={},y.old.get=y.get,y.new={},y.new.get={},y.new.get.email_id=function(e){if(!e){var t=document.querySelectorAll(".adn[data-message-id]");if(!t||0===t.length)return null;e=t[t.length-1]}return y.helper.get.new_email_id(e)},y.new.get.thread_id=function(){var e=document.querySelector("[data-thread-perm-id]");return e?e.dataset.threadPermId:null},y.new.get.email_data=function(e){e=e||y.new.get.email_id();e=y.helper.get.new_email_id(e);return e?y.cache.emailIdCache[e]:null},y.new.get.thread_data=function(e){e=e||y.new.get.thread_id();e=y.helper.get.thread_id(e);return e?y.cache.threadCache[e]:null},"undefined"!=typeof document&&y.tools.xhr_watcher(),"undefined"!=typeof document&&y.tools.embedded_data_watcher(),y};"undefined"!=typeof exports&&(exports.Gmail=Gmail);